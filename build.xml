<?xml version="1.0"?>
<!-- ====================================================================== -->
<!-- ====================================================================== -->

<project
    name="Aye Aye Captain!"
    basedir="."
    default="phonegappkg" >

    <taskdef resource="net/sf/antcontrib/antcontrib.properties" >

        <classpath>

            <pathelement location="lib/ant-contrib-1.0b3.jar" />
        </classpath>
    </taskdef>

    <target
        name="phonegappkg"
        depends="" >

        <exec executable="zip" >

            <arg value="-r" />

            <arg value="iicaptain" />

            <arg value="www" />
        </exec>

        <foreach
            list="ios,bb,android,wp7"
            param="os"
            target="addOSSpecifics" >
        </foreach>
    </target>

    <target name="addOSSpecifics" >

        <switch value="${os}" >

            <case value="ios" >

                <var
                    name="id"
                    value="140698" />
            </case>

            <case value="android" >

                <var
                    name="id"
                    value="105617" />
            </case>

            <case value="bb" >

                <var
                    name="id"
                    value="140898" />
            </case>

            <case value="wp7" >

                <var
                    name="id"
                    value="140903" />
            </case>
        </switch>

        <copy
            file="iicaptain.zip"
            tofile="iicaptain-${os}.zip" >
        </copy>

        <zip
            basedir="phonegap/${os}"
            destfile="iicaptain-${os}.zip"
            update="true" >
        </zip>

        <exec executable="curl" >

            <arg value="-F" />

            <arg value="file=@iicaptain-${os}.zip" />

            <arg value="-X" />

            <arg value="PUT" />

            <arg value="https://build.phonegap.com/api/v1/apps/${id}?auth_token=i1c3E6MMYymBTe1Y6mBN" />
        </exec>
    </target>

    <target name="clean" >

        <delete dir="${classes.dir}" />

        <delete dir="${jars.dir}" />

        <delete file="iicaptain.zip" />

        <delete file="iicaptain-ios.zip" />

        <delete file="iicaptain-android.zip" />

        <delete file="iicaptain-bb.zip" />

        <delete file="iicaptain-wp7.zip" />
    </target>

</project>